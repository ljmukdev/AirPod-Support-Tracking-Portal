<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="LJM AirPod Support - Register your warranty and get setup assistance">
    <title>Warranty Registration | LJM AirPod Support</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/ios-mobile-optimizations.css">
    <link rel="stylesheet" href="css/global-header.css">
    <script>
        // Inline version display - always runs immediately
        (function() {
            function showVersion() {
                // Remove any existing version displays (from version.js or previous runs)
                var existing = document.getElementById('version-display') || document.querySelector('.version-display');
                if (existing) {
                    existing.remove();
                }
                
                var el = document.createElement('div');
                el.id = 'version-display';
                el.className = 'version-display';
                el.style.cssText = 'position:fixed;top:10px;right:10px;font-size:0.7rem;color:rgba(0,0,0,0.7);font-family:"Courier New",monospace;z-index:99999;padding:4px 8px;background:rgba(255,255,255,0.9);border-radius:4px;box-shadow:0 1px 3px rgba(0,0,0,0.2);pointer-events:none;';
                el.textContent = 'v1.2.3.030';
                el.title = 'Version 1.2.3 (Revision 030)';
                if (document.body) {
                    document.body.appendChild(el);
                } else {
                    setTimeout(function() {
                        if (document.body) document.body.appendChild(el);
                    }, 100);
                }
                
                // Fetch version from API to ensure it's up to date
                fetch('/api/version')
                    .then(function(res) { return res.json(); })
                    .then(function(data) {
                        if (data && data.version && data.revision) {
                            el.textContent = 'v' + data.version + '.' + data.revision;
                            el.title = 'Version ' + data.version + ' (Revision ' + data.revision + ')';
                        }
                    })
                    .catch(function(err) {
                        console.log('Version fetch failed, using inline version');
                    });
            }
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', showVersion);
            } else {
                showVersion();
            }
            setTimeout(showVersion, 1000);
        })();
    </script>
    <script>
        // Staging environment banner
        (function() {
            fetch('/api/version')
                .then(res => res.json())
                .then(data => {
                    // Check if we're in staging (you can set this via environment variable or API)
                    const isStaging = window.location.hostname.includes('staging') || 
                                     window.location.hostname.includes('test') ||
                                     document.cookie.includes('staging=true');
                    
                    if (isStaging) {
                        const banner = document.createElement('div');
                        banner.style.cssText = 'position:fixed;top:0;left:0;right:0;background:#ff9800;color:white;text-align:center;padding:8px;font-weight:600;z-index:100000;box-shadow:0 2px 4px rgba(0,0,0,0.2);';
                        banner.textContent = '⚠️ STAGING ENVIRONMENT - TESTING ONLY';
                        document.body.insertBefore(banner, document.body.firstChild);
                        // Add padding to body to account for banner
                        document.body.style.paddingTop = '40px';
                    }
                })
                .catch(() => {});
        })();
    </script>
    <style>
        /* Body and Layout */
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'San Francisco', 'Segoe UI', sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }
        
        /* Focus Overlay - Removed grey overlay */
        .focus-overlay {
            display: none !important;
        }
        
        /* Header - Match homepage exactly */
        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 1px 0 rgba(0, 0, 0, 0.05);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: box-shadow 0.3s ease;
        }
        
        .header.scrolled {
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            box-sizing: border-box;
        }
        
        /* Ensure logo stays on left, not centered */
        .header-content .logo {
            margin-left: 0;
            margin-right: auto;
        }
        
        @media (min-width: 640px) {
            .header-content {
                padding: 0 32px;
            }
        }
        
        @media (min-width: 1024px) {
            .header-content {
                padding: 0 48px;
            }
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 44px;
            height: 44px;
            background: #284064;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 15px;
            letter-spacing: -0.5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #f5f7fa;
        }
        
        .logo-text {
            color: #1a1a1a;
            font-size: 18px;
            font-weight: 600;
            letter-spacing: -0.3px;
        }
        
        .logo-text span {
            color: #6c757d;
            font-weight: 400;
        }
        
        .nav-links {
            display: flex;
            gap: 36px;
        }
        
        .nav-links a {
            color: #6c757d;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
            position: relative;
        }
        
        .nav-links a:hover {
            color: #1a1a1a;
        }
        
        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #284064;
            transform: scaleX(0);
            transition: transform 0.2s;
        }
        
        .nav-links a:hover::after {
            transform: scaleX(1);
        }
        
        @media (max-width: 640px) {
            .nav-links {
                display: none;
            }
        }
        
        /* Progress Indicator */
        .progress-indicator {
            background: white;
            border-bottom: 1px solid #e8ecf1;
            padding: 16px 0;
            position: sticky;
            top: 73px;
            z-index: 99;
        }
        
        .progress-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .progress-steps {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }
        
        .progress-step {
            flex: 1;
            height: 4px;
            background: #e8ecf1;
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-step.active {
            background: #284064;
        }
        
        .progress-step.completed {
            background: #28a745;
        }
        
        .progress-text {
            font-size: 12px;
            color: #6c757d;
            font-weight: 500;
            white-space: nowrap;
        }
        
        /* Container Styles */
        .container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px 24px 40px 24px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
        }
        
        /* Card Styles - Match homepage */
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            width: 100%;
            overflow: hidden;
        }
        
        .card-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            padding: 36px 48px;
            text-align: center;
            position: relative;
        }
        
        @media (min-width: 768px) {
            .card-header {
                padding: 40px 48px;
            }
        }
        
        .card-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.02'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3Ccircle cx='30' cy='10' r='2'/%3E%3Ccircle cx='30' cy='50' r='2'/%3E%3Ccircle cx='10' cy='30' r='2'/%3E%3Ccircle cx='50' cy='30' r='2'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Ccircle cx='50' cy='50' r='2'/%3E%3Ccircle cx='10' cy='50' r='2'/%3E%3Ccircle cx='50' cy='10' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            background-repeat: repeat;
        }
        
        .card-header h1 {
            color: white;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            letter-spacing: -0.5px;
        }
        
        .card-header p {
            color: rgba(255, 255, 255, 0.85);
            font-size: 16px;
            line-height: 1.6;
            position: relative;
            z-index: 1;
            max-width: 480px;
            margin: 0 auto;
        }
        
        .card-body {
            padding: 36px 48px;
        }
        
        @media (min-width: 768px) {
            .card-body {
                padding: 40px 48px;
            }
        }
        
        @media (max-width: 640px) {
            .card-header {
                padding: 32px 24px;
            }
            
            .card-header h1 {
                font-size: 26px;
            }
            
            .card-body {
                padding: 32px 24px;
            }
        }
        
        /* Step Container */
        .step-container {
            display: none;
        }
        
        .step-container.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Security Code Entry */
        .security-code-section {
            text-align: center;
        }
        
        .security-code-section h2 {
            margin-bottom: 8px;
            color: #1a1a1a;
            font-size: 1.75rem;
        }
        
        .security-code-section .subtitle {
            color: #6c757d;
            margin-bottom: 32px;
            font-size: 0.95rem;
        }
        
        .security-input-wrapper {
            position: relative;
            margin-bottom: 24px;
        }
        
        .security-input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #e8ecf1;
            border-radius: 12px;
            font-size: 18px;
            text-align: center;
            letter-spacing: 3px;
            font-family: 'SF Mono', 'Monaco', monospace;
            text-transform: uppercase;
            transition: all 0.3s;
        }
        
        .security-input:focus {
            outline: none;
            border-color: #284064;
            box-shadow: 0 0 0 4px rgba(40, 64, 100, 0.1);
        }
        
        .security-input.valid {
            border-color: #28a745;
        }
        
        .validation-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
            font-size: 20px;
            font-weight: bold;
            color: #28a745;
        }
        
        .validation-icon.show {
            display: block;
        }
        
        .continue-btn {
            width: 100%;
            padding: 18px;
            background: #284064;
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 14px rgba(40, 64, 100, 0.3);
            animation: pulse 2s infinite;
        }
        
        .continue-btn:hover:not(:disabled) {
            background: #1e2f4a;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 64, 100, 0.4);
        }
        
        .continue-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 4px 14px rgba(40, 64, 100, 0.3); }
            50% { box-shadow: 0 4px 20px rgba(40, 64, 100, 0.5); }
        }
        
        .error-message {
            background: #fee;
            color: #c33;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
            display: none;
        }
        
        .error-message.show {
            display: block;
        }
        
        .support-contact {
            text-align: center;
            padding: 24px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-top: 24px;
            display: none;
        }
        
        .support-contact.show {
            display: block;
        }
        
        /* Success Animation */
        .success-animation {
            text-align: center;
            padding: 48px 24px;
            display: none;
        }
        
        .success-animation.show {
            display: block;
            animation: scaleIn 0.5s ease;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: #28a745;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            animation: checkmark 0.6s ease 0.3s both;
        }
        
        @keyframes checkmark {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Warranty Confirmation */
        .warranty-confirmation {
            padding: 24px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .warranty-warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
            color: #856404;
        }
        
        /* Extended Warranty Options */
        .warranty-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 32px 0;
        }
        
        .warranty-card {
            border: 3px solid #e8ecf1;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
        }
        
        .warranty-card:hover {
            border-color: #284064;
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(40, 64, 100, 0.15);
        }
        
        .warranty-card.selected {
            border-color: #284064;
            background: rgba(40, 64, 100, 0.05);
            box-shadow: 0 4px 16px rgba(40, 64, 100, 0.2);
        }
        
        .warranty-card.grayed-out {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .warranty-badge {
            position: absolute;
            top: -12px;
            right: 16px;
            background: #28a745;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .warranty-card h3 {
            margin: 0 0 12px 0;
            color: #1a1a1a;
            font-size: 1.25rem;
        }
        
        .warranty-price {
            font-size: 2rem;
            font-weight: bold;
            color: #284064;
            margin: 16px 0;
        }
        
        .warranty-details {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 12px;
        }
        
        .countdown-timer {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 12px;
            margin: 24px 0;
            text-align: center;
            font-weight: 600;
            color: #856404;
        }
        
        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 24px;
            flex-wrap: wrap;
        }
        
        .trust-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #6c757d;
            font-size: 0.85rem;
        }
        
        .skip-link {
            text-align: center;
            margin-top: 24px;
        }
        
        .skip-link a {
            color: #adb5bd;
            font-size: 0.85rem;
            text-decoration: none;
        }
        
        /* Accessory Upsell */
        .accessory-section {
            margin: 32px 0;
        }
        
        .bundle-label {
            background: #284064;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 24px;
        }
        
        .accessory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }
        
        .accessory-item {
            border: 2px solid #e8ecf1;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .accessory-item:hover {
            border-color: #284064;
        }
        
        .accessory-item.selected {
            border-color: #284064;
            background: rgba(40, 64, 100, 0.05);
        }
        
        .stock-warning {
            color: #dc3545;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .price-comparison {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 12px;
        }
        
        .original-price {
            text-decoration: line-through;
            color: #6c757d;
        }
        
        .bundle-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #28a745;
        }
        
        /* Setup Instructions */
        .setup-steps {
            margin: 32px 0;
        }
        
        .setup-step {
            border: 2px solid #e8ecf1;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 16px;
            display: none;
        }
        
        .setup-step.active {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .step-checkbox {
            margin-top: 16px;
        }
        
        .step-checkbox label {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }
        
        /* Exit Intent Modal */
        .exit-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .exit-modal.show {
            display: flex;
        }
        
        .exit-modal-content {
            background: white;
            border-radius: 20px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .exit-modal h3 {
            margin-bottom: 16px;
            color: #1a1a1a;
        }
        
        .exit-modal p {
            color: #6c757d;
            margin-bottom: 24px;
        }
        
        .exit-modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #284064;
            color: white;
        }
        
        .btn-secondary {
            background: #e8ecf1;
            color: #1a1a1a;
        }
        
        /* Mobile Optimizations */
        @media (max-width: 640px) {
            .warranty-options {
                grid-template-columns: 1fr;
            }

            .accessory-grid {
                grid-template-columns: 1fr;
            }

            .continue-btn {
                padding: 16px;
                font-size: 15px;
                min-height: 48px; /* Larger touch target */
            }

            .trust-badges {
                flex-direction: column;
                gap: 12px;
            }

            .btn {
                min-height: 44px; /* Larger touch target */
                padding: 14px 24px;
            }

            .warranty-card {
                padding: 12px 10px;
            }

            .accessory-item {
                padding: 12px 10px;
                min-height: 110px;
            }

            .security-input {
                font-size: 16px; /* Prevent zoom on iOS */
            }

            .step-container {
                padding: 12px 8px;
            }

            .card-body {
                padding: 12px 8px;
            }
        }

        @media (max-width: 480px) {
            .warranty-card {
                padding: 4px 0px;
            }

            .accessory-item {
                padding: 4px 0px;
                min-height: 100px;
            }

            .step-container {
                padding: 4px 0px;
            }

            .card-body {
                padding: 4px 0px;
            }

            .product-details {
                gap: 12px;
                margin-bottom: 16px;
            }

            /* Add padding to security-code-section to prevent form overflow */
            .security-code-section {
                padding: 0 8px !important;
            }

            /* Ensure consistent input alignment on mobile */
            .security-input {
                padding: 14px !important;
                padding-left: 14px !important;
                padding-right: 14px !important;
                font-size: 16px !important;
                box-sizing: border-box !important;
            }

            /* Override any inline padding styles for form inputs */
            #contactName,
            #contactEmail,
            #contactPhone,
            #reconditionEmail,
            #reconditionPhone,
            #reconditionAddress {
                padding: 14px !important;
            }

            /* Increase padding inside verification white box for breathing room */
            .verification-step > div {
                padding: 20px 16px !important;
            }

            /* Add padding around example images grid */
            #compatiblePartsExamplesGrid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)) !important;
                gap: 14px !important;
                justify-items: center;
                margin: 0 auto;
                padding: 0 12px;
            }

            /* Add margin to the examples container */
            #compatiblePartsExamples {
                margin: 18px 0 !important;
            }

            /* Center carousel container */
            .carousel-container {
                justify-content: center;
            }
        }
        
        /* Prevent zoom on input focus (iOS) */
        @media (max-width: 640px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
        
        /* Product Details */
        .product-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .product-detail-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .detail-label {
            color: #6c757d;
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        .detail-value {
            color: #1a1a1a;
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        /* Photo Carousel Styles */
        .photo-carousel {
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .carousel-container {
            flex: 1;
            display: flex;
            gap: 12px;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: #cbd5e0 transparent;
            padding: 8px 0;
        }
        
        .carousel-container::-webkit-scrollbar {
            height: 6px;
        }
        
        .carousel-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .carousel-container::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
        }
        
        .carousel-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        .carousel-photo {
            flex-shrink: 0;
            width: 150px;
            height: 150px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid #e8ecf1;
            transition: all 0.3s ease;
            background: white;
        }
        
        .carousel-photo:hover {
            border-color: #284064;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 64, 100, 0.2);
        }
        
        .carousel-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .carousel-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #284064;
            background: white;
            color: #284064;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .carousel-button:hover {
            background: #284064;
            color: white;
        }
        
        .carousel-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .carousel-indicators {
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .carousel-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #cbd5e0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .carousel-indicator.active {
            background: #284064;
            width: 24px;
            border-radius: 4px;
        }
        
        /* Image Modal Styles */
        .image-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
        }
        
        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(4px);
        }
        
        .modal-content {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            z-index: 1;
        }
        
        .modal-content img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .modal-close {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 2px solid white;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 0;
            font-weight: bold;
            line-height: 1;
            cursor: pointer;
            display: flex !important;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10003;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            pointer-events: auto;
        }
        
        .modal-close::before,
        .modal-close::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 2px;
            background: white;
            border-radius: 1px;
        }
        
        .modal-close::before {
            transform: rotate(45deg);
        }
        
        .modal-close::after {
            transform: rotate(-45deg);
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: scale(1.1);
        }
        
        .modal-close:hover::before,
        .modal-close:hover::after {
            background: #1a1a1a;
        }
        
        .modal-close:active {
            transform: scale(0.95);
        }
        
        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid white;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10001;
        }
        
        .modal-nav:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .modal-prev {
            left: 20px;
        }
        
        .modal-next {
            right: 20px;
        }
        
        @media (max-width: 768px) {
            .carousel-photo {
                width: 140px;
                height: 140px;
            }

            .carousel-button {
                width: 36px;
                height: 36px;
                font-size: 22px;
            }

            .modal-content {
                padding: 20px;
            }

            .modal-close {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
                z-index: 10003;
            }

            .modal-close::before,
            .modal-close::after {
                width: 18px;
                height: 2px;
            }

            .modal-nav {
                width: 40px;
                height: 40px;
                font-size: 24px;
            }

            .modal-prev {
                left: 10px;
            }

            .modal-next {
                right: 10px;
            }
        }

        @media (max-width: 480px) {
            .photo-carousel {
                gap: 8px;
            }

            .carousel-photo {
                width: 110px;
                height: 110px;
            }

            .carousel-button {
                width: 32px;
                height: 32px;
                font-size: 18px;
            }

            .carousel-container {
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Focus Overlay -->
    <div class="focus-overlay" id="focusOverlay"></div>
    
    <!-- Header -->
    <header class="header" id="mainHeader">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">LJM</div>
                <div class="logo-text">Support <span>Center</span></div>
            </div>
            <nav class="nav-links">
                <a href="terms-and-conditions.html">Terms</a>
                <a href="privacy-policy.html">Privacy</a>
            </nav>
        </div>
    </header>
    
    <!-- Progress Indicator -->
    <div class="progress-indicator" id="progressIndicator" style="display: none;">
        <div class="progress-content">
            <div class="progress-steps" id="progressSteps"></div>
            <div class="progress-text" id="progressText">Step 1 of 7</div>
        </div>
    </div>

    <main class="container">
        <div class="card">
            <div class="card-header">
                <h1>Warranty Registration</h1>
                <p>Register your AirPod replacement part and activate your warranty coverage</p>
            </div>
            
            <div class="card-body">
                <!-- Step 1: Security Code Entry / Product Verification -->
                <div class="step-container" id="step1" data-step="1">
                    <div class="security-code-section">
                        <!-- Security Code Entry (shown when not coming from home page) -->
                        <div id="securityCodeEntrySection">
                            <h2>Enter Your Security Code</h2>
                            <p class="subtitle">Enter the security code from your product packaging to begin warranty registration</p>
                            
                            <div class="security-input-wrapper">
                                <input
                                    type="text"
                                    id="securityCodeInput"
                                    class="security-input"
                                    placeholder="XXXX-XXXX-XXXX"
                                    maxlength="20"
                                    autocomplete="off"
                                    inputmode="text"
                                    autocapitalize="characters"
                                    spellcheck="false"
                                    enterkeyhint="go"
                                >
                                <span class="validation-icon" id="validationIcon">✓</span>
                            </div>
                            <div class="error-message" id="errorMessage"></div>
                            <div class="support-contact" id="supportContact">
                                <h3>Please call support for assistance</h3>
                                <p style="font-size: 1.25rem; font-weight: 600; color: #284064; margin-top: 12px;">1-800-555-0123</p>
                            </div>
                        </div>
                        
                        <!-- Product Record Display (shown after validation or when coming from home page) -->
                        <div id="productRecordDisplay" style="display: none; margin-top: 32px;">
                            <div style="background: #f8f9fa; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                                <h3 style="margin-top: 0; color: #1a1a1a; margin-bottom: 8px;">✓ Product Found</h3>
                                <p id="ebayOrderNumberDisplay" style="color: #6c757d; margin-bottom: 16px; font-size: 0.9rem; display: none;"></p>
                                <p style="color: #6c757d; margin-bottom: 20px;">Please verify this matches the product you purchased before continuing:</p>
                                
                                <!-- Product Details -->
                                <div class="product-details" id="productDetailsStep1"></div>
                                
                                <!-- Photo Carousel -->
                                <div id="photoCarouselStep1" style="margin: 24px 0; display: none;">
                                    <h4 style="margin: 0 0 16px 0; color: #1a1a1a; font-size: 1rem; font-weight: 600;">Product Photos</h4>
                                    <div class="photo-carousel">
                                        <button class="carousel-button carousel-prev" id="carouselPrevStep1" aria-label="Previous photo">‹</button>
                                        <div class="carousel-container" id="carouselContainerStep1">
                                            <!-- Photos will be inserted here -->
                                        </div>
                                        <button class="carousel-button carousel-next" id="carouselNextStep1" aria-label="Next photo">›</button>
                                    </div>
                                    <div class="carousel-indicators" id="carouselIndicatorsStep1">
                                        <!-- Indicators will be inserted here -->
                                    </div>
                                </div>
                                
                                <!-- Step-by-Step Verification -->
                                <div id="verificationSteps" style="margin-top: 24px;">
                                    <!-- Step 1: Compatibility Check -->
                                    <div class="verification-step" data-step="1" style="display: none;">
                                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 12px;">Are your existing parts compatible?</h4>
                                            <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6;">
                                                You purchased <strong style="color: #284064;" id="purchasedPartNumber">-</strong>.<br>
                                                Make sure you have parts <strong style="color: #284064;" id="compatiblePartNumbers">-</strong>.
                                            </p>
                                            
                                            <!-- Example Images of Compatible Parts -->
                                            <div id="compatiblePartsExamples" style="margin: 20px 0; display: none;">
                                                <p style="color: #6c757d; font-size: 0.9rem; margin-bottom: 12px; font-weight: 600;">Example images of compatible parts:</p>
                                                <div id="compatiblePartsExamplesGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 16px;">
                                                    <!-- Example images will be inserted here -->
                                                </div>
                                            </div>
                                            
                                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                                    <input type="radio" name="verifyCompatibility" id="verifyCompatibilityYes" value="yes" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">Yes, my existing parts are compatible</span>
                                                </label>
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                                    <input type="radio" name="verifyCompatibility" id="verifyCompatibilityNo" value="no" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">No, my parts are not compatible</span>
                                                </label>
                                            </div>
                                            
                                            <!-- Compatibility Explanation (shown when "No" is selected) -->
                                            <div id="compatibilityExplanation" style="display: none; margin-top: 20px; padding: 20px; background: #e7f3ff; border: 2px solid #0064D2; border-radius: 8px;">
                                                <h5 style="color: #0064D2; margin-top: 0; margin-bottom: 12px; font-size: 1rem; font-weight: 600;">Understanding Compatibility</h5>
                                                <p style="color: #1a1a1a; margin-bottom: 12px; line-height: 1.6;">
                                                    <strong>Important:</strong> AirPod replacement parts are designed to work only with compatible parts from the same generation. 
                                                    Each part in your AirPod set (left earbud, right earbud, and case) must be compatible with each other for the system to function properly.
                                                </p>
                                                <p style="color: #1a1a1a; margin-bottom: 12px; line-height: 1.6;">
                                                    The part you purchased (<strong id="purchasedPartNumberExplanation">-</strong>) will only function correctly when paired with the specific compatible parts it was designed for 
                                                    (<strong id="compatiblePartNumbersExplanation">-</strong>).
                                                </p>
                                                <p style="color: #1a1a1a; margin-bottom: 0; line-height: 1.6;">
                                                    If your existing parts are not compatible with the part you purchased, they will not work together properly. 
                                                    This is a technical limitation of how AirPods are designed and paired by Apple.
                                                </p>
                                                <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #b3d9ff;">
                                                    <button type="button" onclick="window.location.href='ebay-return.html'" style="padding: 10px 20px; background: #0064D2; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                                        Continue to Return Process
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Step 2: Authenticity Check -->
                                    <div class="verification-step" data-step="2" style="display: none;">
                                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 12px;">Are your existing parts authentic?</h4>
                                            <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6;">
                                                Check inside your case lid or on the AirPod stem for these markings:
                                            </p>
                                            
                                            <!-- Location Diagrams - Dynamically Updated -->
                                            <div id="authenticityImagesGrid" style="display: none; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                                                <div id="caseImageContainer" style="background: white; padding: 16px; border-radius: 8px; border: 2px solid #e8ecf1; text-align: center; display: none;">
                                                    <img id="authenticityCaseImage" src="" alt="Markings inside case lid" style="width: 100%; max-width: 400px; height: auto; display: block; margin: 0 auto 8px; border-radius: 8px; cursor: pointer;">
                                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Case: Open lid and look inside</div>
                                                </div>
                                                <div id="airpodImageContainer" style="background: white; padding: 16px; border-radius: 8px; border: 2px solid #e8ecf1; text-align: center; display: none;">
                                                    <img id="authenticityAirPodImage" src="" alt="Markings on AirPod stem" style="width: 100%; max-width: 300px; height: auto; display: block; margin: 0 auto 8px; border-radius: 8px; cursor: pointer;">
                                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">AirPod: Check the stem</div>
                                                </div>
                                            </div>
                                            
                                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                                    <input type="radio" name="verifyAuthenticity" id="verifyAuthenticityYes" value="yes" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">Yes, my parts have the correct markings</span>
                                                </label>
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                                    <input type="radio" name="verifyAuthenticity" id="verifyAuthenticityNo" value="no" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">No, my parts do not have the correct markings</span>
                                                </label>
                                            </div>
                                            
                                            <!-- Authenticity Explanation (shown when "No" is selected) -->
                                            <div id="authenticityExplanation" style="display: none; margin-top: 20px; padding: 20px; background: #e7f3ff; border: 2px solid #0064D2; border-radius: 8px;">
                                                <h5 style="color: #0064D2; margin-top: 0; margin-bottom: 12px; font-size: 1rem; font-weight: 600;">How to Check Authenticity</h5>
                                                <p style="color: #1a1a1a; margin-bottom: 12px; line-height: 1.6;">
                                                    <strong>Checking Serial Numbers:</strong> Apple manufactures each AirPod part (left earbud, right earbud, and case) with a <strong>unique serial number</strong> that is different for each component.
                                                </p>
                                                <p style="color: #1a1a1a; margin-bottom: 12px; line-height: 1.6;">
                                                    <strong>Where to Find Serial Numbers:</strong>
                                                </p>
                                                <ul style="color: #1a1a1a; margin-bottom: 12px; padding-left: 20px; line-height: 1.8;">
                                                    <li><strong>Case:</strong> Open the lid and look inside the case - you should see a serial number</li>
                                                    <li><strong>Left AirPod:</strong> Check the stem of the left earbud</li>
                                                    <li><strong>Right AirPod:</strong> Check the stem of the right earbud</li>
                                                </ul>
                                                <p style="color: #1a1a1a; margin-bottom: 12px; line-height: 1.6;">
                                                    <strong>Identifying Counterfeit AirPods:</strong> If you find that all your AirPod parts have identical serial numbers, or if serial numbers are missing, this indicates the items are counterfeit. 
                                                    Counterfeit manufacturers replicate the serial number from the packaging box (which matches the case serial number) onto all parts, making them appear genuine when checked through Apple's online serial number identifier tool.
                                                </p>
                                                <p style="color: #1a1a1a; margin-bottom: 0; line-height: 1.6;">
                                                    <strong>Authentic AirPods</strong> will always have three distinct serial numbers - one for each earbud and one for the case.
                                                </p>
                                                <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #b3d9ff;">
                                                    <button type="button" onclick="window.location.href='ebay-return.html'" style="padding: 10px 20px; background: #0064D2; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                                        Continue to Return Process
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Step 3: Serial Number Uniqueness -->
                                    <div class="verification-step" data-step="3" style="display: none;">
                                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 12px;">Does each part have a different serial number?</h4>
                                            <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6;">
                                                Authentic AirPods have unique serial numbers on each part (left AirPod, right AirPod, and case). Check that each serial number is different.
                                            </p>
                                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                                    <input type="radio" name="verifySerialNumbers" id="verifySerialNumbersYes" value="yes" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">Yes, each part has a different serial number</span>
                                                </label>
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                                    <input type="radio" name="verifySerialNumbers" id="verifySerialNumbersNo" value="no" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">No, the serial numbers are the same or missing</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Step 4: Condition Check -->
                                    <div class="verification-step" data-step="4" style="display: none;">
                                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 12px;">Are you happy with the product condition?</h4>
                                            <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6;">
                                                Review the product photos above. Check that the condition matches what you expected.
                                            </p>
                                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                                    <input type="radio" name="verifyCondition" id="verifyConditionYes" value="yes" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">Yes, the condition is acceptable</span>
                                                </label>
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                                    <input type="radio" name="verifyCondition" id="verifyConditionNo" value="no" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">No, the condition is not acceptable</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Step 5: Final Confirmation -->
                                    <div class="verification-step" data-step="5" style="display: none;">
                                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 12px;">Ready to proceed?</h4>
                                            <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6;">
                                                If you need to return this item, do so through the platform you purchased it from and mark it as "Ordered the wrong item".
                                            </p>
                                            <div class="warranty-warning" style="margin-bottom: 16px;">
                                                <strong>⚠️ Remember:</strong> Do NOT open the packaging until you're certain this is the correct item.
                                            </div>
                                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                                    <input type="radio" name="verifyReady" id="verifyReadyYes" value="yes" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">I'm ready to continue with warranty registration</span>
                                                </label>
                                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                                    <input type="radio" name="verifyReady" id="verifyReadyNo" value="no" style="width: 20px; height: 20px; cursor: pointer;">
                                                    <span style="color: #1a1a1a; font-weight: 500;">I want to return this item</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="continue-btn" id="continueBtn1" disabled>Continue</button>
                    </div>
                </div>
                
                <!-- Return Process Step (shown when user selects "I want to return this item" on step 5) -->
                <div id="returnProcessStep" style="display: none;">
                    <div class="card-body">
                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 16px;">Return Process</h4>
                            
                            <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                                <strong style="color: #856404;">⚠️ Important:</strong>
                                <p style="color: #856404; margin: 8px 0 0 0; line-height: 1.6;">
                                    Please do NOT open the packaging if you plan to return the item. 
                                    Items that have been opened will only receive a 50% refund.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <h5 style="color: #1a1a1a; margin-bottom: 12px; font-size: 1rem;">How to Return:</h5>
                                <ol style="color: #6c757d; line-height: 1.8; padding-left: 20px; margin: 0;">
                                    <li>Go to your eBay Purchase History</li>
                                    <li>Find the order for this AirPod replacement part</li>
                                    <li>Click on the order and select "Return this item" or "Request a return"</li>
                                    <li>When prompted for the return reason, select <strong>"Ordered the wrong item"</strong></li>
                                    <li>Follow eBay's instructions to print the return label and send the item back</li>
                                    <li>Make sure to include all original packaging</li>
                                </ol>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <h5 style="color: #1a1a1a; margin-bottom: 12px; font-size: 1rem;">Feedback Form</h5>
                                <p style="color: #6c757d; margin-bottom: 12px; font-size: 0.9rem;">
                                    Please help us improve by telling us why you're returning this item:
                                </p>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Reason for Return *</label>
                                    <select id="returnReason" style="width: 100%; padding: 12px; border: 2px solid #e8ecf1; border-radius: 8px; font-size: 0.95rem; background: white;" required>
                                        <option value="">Please select a reason</option>
                                        <option value="parts_not_compatible">My existing parts are not compatible</option>
                                        <option value="parts_counterfeit">My existing parts appear to be counterfeit</option>
                                        <option value="wrong_part_received">I received the wrong part</option>
                                        <option value="changed_mind">I changed my mind</option>
                                        <option value="found_better_deal">Found a better deal elsewhere</option>
                                        <option value="other">Other reason</option>
                                    </select>
                        </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Additional Comments (Optional)</label>
                                    <textarea id="returnComments" rows="4" style="width: 100%; padding: 12px; border: 2px solid #e8ecf1; border-radius: 8px; font-size: 0.95rem; font-family: inherit; resize: vertical;" placeholder="Please provide any additional details about your return..."></textarea>
                                </div>
                                <button type="button" id="submitReturnFeedback" class="continue-btn" style="background: #dc3545; margin-top: 8px;">
                                    Submit Feedback & Continue to Return Instructions
                                </button>
                            </div>
                        </div>
                        </div>
                    </div>
                    
                <!-- Authenticity Check Step (shown when user selects "No" on serial number uniqueness) -->
                <div id="authenticityCheckStep" style="display: none;">
                    <div class="card-body">
                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 16px;">Authenticity Check</h4>
                            
                            <div style="background: #e7f3ff; border: 2px solid #0064D2; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                                <p style="color: #1a1a1a; margin: 0; line-height: 1.6;">
                                    <strong>Important:</strong> If your AirPod parts have identical serial numbers or missing serial numbers, they may be counterfeit. 
                                    Please check the authenticity markings on your existing parts using the images below.
                                </p>
                    </div>
                    
                            <div style="margin-bottom: 24px;">
                                <h5 style="color: #1a1a1a; margin-bottom: 12px; font-size: 1rem;">Check Your Parts for These Markings:</h5>
                                
                                <!-- Authenticity Images Grid -->
                                <div id="authenticityCheckImagesGrid" style="display: grid; grid-template-columns: 1fr; gap: 16px; margin-bottom: 16px;">
                                    <div id="authenticityCheckCaseContainer" style="background: white; padding: 16px; border-radius: 8px; border: 2px solid #e8ecf1; text-align: center; display: none;">
                                        <img id="authenticityCheckCaseImage" src="" alt="Markings inside case lid" style="width: 100%; max-width: 400px; height: auto; display: block; margin: 0 auto 8px; border-radius: 8px; cursor: pointer;">
                                        <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">Case: Open lid and look inside</div>
                                    </div>
                                    <div id="authenticityCheckAirpodContainer" style="background: white; padding: 16px; border-radius: 8px; border: 2px solid #e8ecf1; text-align: center; display: none;">
                                        <img id="authenticityCheckAirpodImage" src="" alt="Markings on AirPod stem" style="width: 100%; max-width: 300px; height: auto; display: block; margin: 0 auto 8px; border-radius: 8px; cursor: pointer;">
                                        <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600;">AirPod: Check the stem</div>
                                    </div>
                    </div>
                    
                                <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6;">
                                    Look for regulatory markings such as <strong>CE</strong>, <strong>R-NZ</strong>, or other certification marks that indicate authentic Apple products.
                                </p>
                </div>
                
                            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e8ecf1;">
                                <button type="button" onclick="window.location.href='ebay-return.html'" style="padding: 10px 20px; background: #0064D2; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                    Continue to Return Process
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Second-Level Authenticity Check Step (shown when user selects "Yes" on serial number uniqueness) -->
                <div id="secondLevelAuthenticityStep" style="display: none;">
                    <div class="card-body">
                        <div style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px;">
                            <h4 style="margin-top: 0; color: #1a1a1a; font-size: 1.1rem; margin-bottom: 16px;">Additional Authenticity Verification</h4>
                            
                            <p style="color: #6c757d; margin-bottom: 20px; line-height: 1.6;">
                                Great! Your parts have unique serial numbers. As an additional layer of protection, please verify that your existing parts have the recognized authenticity markings shown below.
                            </p>
                            
                            <!-- Authenticity Images Grid -->
                            <div id="secondLevelAuthenticityImagesGrid" style="display: grid; grid-template-columns: 1fr; gap: 16px; margin-bottom: 24px;">
                                <div id="secondLevelCaseContainer" style="background: white; padding: 16px; border-radius: 8px; border: 2px solid #e8ecf1; text-align: center; display: none;">
                                    <img id="secondLevelCaseImage" src="" alt="Markings inside case lid" style="width: 100%; max-width: 400px; height: auto; display: block; margin: 0 auto 8px; border-radius: 8px; cursor: pointer;">
                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600; margin-bottom: 8px;">Case: Open lid and look inside</div>
                                    <div style="font-size: 0.8rem; color: #6c757d;">Look for CE, R-NZ, or other regulatory markings</div>
                                </div>
                                <div id="secondLevelAirpodContainer" style="background: white; padding: 16px; border-radius: 8px; border: 2px solid #e8ecf1; text-align: center; display: none;">
                                    <img id="secondLevelAirpodImage" src="" alt="Markings on AirPod stem" style="width: 100%; max-width: 300px; height: auto; display: block; margin: 0 auto 8px; border-radius: 8px; cursor: pointer;">
                                    <div style="font-size: 0.85rem; color: #6c757d; font-weight: 600; margin-bottom: 8px;">AirPod: Check the stem</div>
                                    <div style="font-size: 0.8rem; color: #6c757d;">Look for CE, R-NZ, or other regulatory markings</div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <h5 style="color: #1a1a1a; margin-bottom: 12px; font-size: 1rem;">Do your existing parts have these recognized markings?</h5>
                                <p style="color: #6c757d; margin-bottom: 16px; line-height: 1.6; font-size: 0.9rem;">
                                    Authentic Apple AirPods will have regulatory markings such as <strong>CE</strong> (European Conformity), <strong>R-NZ</strong> (New Zealand Radio Compliance), or other certification marks. 
                                    These markings indicate that the product meets international safety and quality standards.
                                </p>
                                
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                                        <input type="radio" name="verifyMarkings" id="verifyMarkingsYes" value="yes" style="width: 20px; height: 20px; cursor: pointer;">
                                        <span style="color: #1a1a1a; font-weight: 500;">Yes, my parts have the recognized markings (CE, R-NZ, etc.)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                        <input type="radio" name="verifyMarkings" id="verifyMarkingsNo" value="no" style="width: 20px; height: 20px; cursor: pointer;">
                                        <span style="color: #1a1a1a; font-weight: 500;">No, my parts do not have these markings</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Explanation shown when "No" is selected -->
                            <div id="markingsExplanation" style="display: none; margin-top: 20px; padding: 20px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                <h5 style="color: #856404; margin-top: 0; margin-bottom: 12px; font-size: 1rem; font-weight: 600;">Missing Authenticity Markings</h5>
                                <p style="color: #856404; margin-bottom: 12px; line-height: 1.6;">
                                    If your parts are missing regulatory markings like CE or R-NZ, this may indicate that they are not genuine Apple products. 
                                    Authentic Apple AirPods will always have these markings to comply with international safety standards.
                                </p>
                                <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #ffc107;">
                                    <button type="button" onclick="window.location.href='ebay-return.html'" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                                        Continue to Return Process
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <script>
                    // Immediately hide step 1 if barcode is in URL (prevents flash of duplicate entry)
                    (function() {
                        const urlParams = new URLSearchParams(window.location.search);
                        if (urlParams.get('barcode')) {
                            const step1 = document.getElementById('step1');
                            if (step1) step1.style.display = 'none';
                        }
                    })();
                </script>
                
                <!-- Step 2: Contact Information (moved from step 3) -->
                <div class="step-container" id="step2" data-step="2">
                    <div class="security-code-section">
                        <h2>Contact Information</h2>
                        <p class="subtitle">Please provide your contact details to activate your warranty</p>
                        
                        <div style="margin-bottom: 20px;">
                            <label for="contactName" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Full Name *</label>
                            <input 
                                type="text" 
                                id="contactName" 
                                class="security-input" 
                                placeholder="John Doe" 
                                required
                                style="text-align: left; padding-left: 16px; letter-spacing: normal; text-transform: none;"
                            >
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label for="contactEmail" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Email Address *</label>
                            <input 
                                type="email" 
                                id="contactEmail" 
                                class="security-input" 
                                placeholder="john@example.com" 
                                required
                                style="text-align: left; padding-left: 16px; letter-spacing: normal; text-transform: none;"
                            >
                        </div>
                        
                        <div style="margin-bottom: 24px;">
                            <label for="contactPhone" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Phone Number *</label>
                            <input 
                                type="tel" 
                                id="contactPhone" 
                                class="security-input" 
                                placeholder="+44 7700 900123" 
                                required
                                style="text-align: left; padding-left: 16px; letter-spacing: normal; text-transform: none;"
                            >
                        </div>
                        
                        <!-- Terms & Conditions Section -->
                        <div id="termsSection" style="margin-top: 32px; padding: 20px; background: #f8f9fa; border-radius: 12px; border: 2px solid #e8ecf1;">
                            <h3 style="margin-top: 0; margin-bottom: 16px; color: #1a1a1a; font-size: 1.1rem; display: flex; align-items: center; gap: 8px;">
                                <span id="termsVersion" style="font-size: 0.7rem; color: #6c757d; font-weight: normal;">-</span>
                                <span>Terms & Conditions</span>
                            </h3>
                            <div id="termsContent" style="max-height: 200px; overflow-y: auto; padding: 15px; background: white; border-radius: 8px; margin-bottom: 16px; text-align: left; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;"></div>
                            <div style="display: flex; align-items: start; gap: 12px;">
                                <input 
                                    type="checkbox" 
                                    id="termsAccepted" 
                                    required
                                    style="margin-top: 4px; width: 20px; height: 20px; cursor: pointer;"
                                >
                                <label for="termsAccepted" style="cursor: pointer; color: #1a1a1a; font-size: 0.95rem; line-height: 1.5;">
                                    I have read and agree to the Terms & Conditions
                                </label>
                            </div>
                        </div>
                        
                        <button class="continue-btn" id="continueBtn2">Continue</button>
                    </div>
                </div>
                
                <!-- Step 3: Setup Instructions (moved from step 7) -->
                <div class="step-container" id="step3" data-step="3">
                    <h2 style="text-align: center; margin-bottom: 32px;">Setup Instructions</h2>
                    <div class="setup-steps" id="setupSteps">
                        <div class="setup-step active" data-step-num="1">
                            <h3>Step 1: Prepare Your Device</h3>
                            <p>Make sure your iPhone or iPad is nearby and unlocked. Open the Settings app.</p>
                            <div class="step-checkbox">
                                <label>
                                    <input type="checkbox" data-step="1" data-completed="true">
                                    <span>I've completed this step</span>
                                </label>
                            </div>
                            <div class="step-checkbox" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e8ecf1;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                    <input type="checkbox" data-step="1" data-help="true" style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="color: #856404; font-weight: 500;">I'm struggling with this step / I need help</span>
                                </label>
                            </div>
                        </div>
                        <div class="setup-step" data-step-num="2">
                            <h3>Step 2: Open Bluetooth Settings</h3>
                            <p>Navigate to Settings > Bluetooth and ensure Bluetooth is turned on.</p>
                            <div class="step-checkbox">
                                <label>
                                    <input type="checkbox" data-step="2" data-completed="true">
                                    <span>I've completed this step</span>
                                </label>
                            </div>
                            <div class="step-checkbox" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e8ecf1;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                    <input type="checkbox" data-step="2" data-help="true" style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="color: #856404; font-weight: 500;">I'm struggling with this step / I need help</span>
                                </label>
                            </div>
                        </div>
                        <div class="setup-step" data-step-num="3">
                            <h3>Step 3: Pair Your AirPod</h3>
                            <p>Hold your AirPod near your device with the case open. A connection prompt should appear.</p>
                            <div class="step-checkbox">
                                <label>
                                    <input type="checkbox" data-step="3" data-completed="true">
                                    <span>I've completed this step</span>
                                </label>
                            </div>
                            <div class="step-checkbox" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e8ecf1;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                    <input type="checkbox" data-step="3" data-help="true" style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="color: #856404; font-weight: 500;">I'm struggling with this step / I need help</span>
                                </label>
                            </div>
                        </div>
                        <div class="setup-step" data-step-num="4">
                            <h3>Step 4: Complete Setup</h3>
                            <p>Follow the on-screen instructions to complete the pairing process.</p>
                            <div class="step-checkbox">
                                <label>
                                    <input type="checkbox" data-step="4" data-completed="true">
                                    <span>I've completed this step</span>
                                </label>
                            </div>
                            <div class="step-checkbox" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e8ecf1;">
                                <label style="display: flex; align-items: center; gap: 12px; cursor: pointer; padding: 12px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                    <input type="checkbox" data-step="4" data-help="true" style="width: 20px; height: 20px; cursor: pointer;">
                                    <span style="color: #856404; font-weight: 500;">I'm struggling with this step / I need help</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <button class="continue-btn" id="continueBtn3" style="display: none;">Continue</button>
                </div>
                
                <!-- Step 4: Success Animation & Warranty Confirmation -->
                <div class="step-container" id="step4" data-step="4">
                    <div class="success-animation" id="successAnimation">
                        <div class="success-icon">✓</div>
                        <h2 style="color: #28a745;">Success!</h2>
                    </div>
                    <div class="warranty-confirmation" id="warrantyConfirmation" style="display: none;">
                        <div style="text-align: center; margin-bottom: 32px;">
                            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; box-shadow: 0 4px 20px rgba(40, 167, 69, 0.3);">
                                <span style="font-size: 40px; color: white;">✓</span>
                            </div>
                            <h2 style="color: #1a1a1a; margin-bottom: 8px; font-size: 1.75rem;">🎉 Your Product is Protected!</h2>
                            <p style="color: #6c757d; font-size: 1rem;">Your AirPod has been successfully registered</p>
                        </div>
                        
                        <div class="product-details" id="productDetailsDisplay"></div>
                        
                        <div style="margin-top: 32px; padding: 24px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 16px; border: 2px solid #28a745;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <span style="font-size: 24px;">✓</span>
                                <h4 style="color: #28a745; margin: 0; font-size: 1.25rem;">Standard 30-Day Warranty Active</h4>
                            </div>
                            <p style="color: #6c757d; margin-bottom: 0; font-size: 0.95rem;">Your warranty expires: <strong style="color: #1a1a1a;" id="warrantyExpiry">-</strong></p>
                        </div>
                        
                        <div style="margin-top: 32px; padding: 24px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 16px; border-left: 6px solid #ff9800;">
                            <div style="display: flex; align-items: start; gap: 12px; margin-bottom: 16px;">
                                <span style="font-size: 24px;">⚠️</span>
                                <div style="flex: 1;">
                                    <h4 style="color: #856404; margin: 0 0 8px 0; font-size: 1.1rem;">Did You Know?</h4>
                                    <p style="color: #856404; margin: 0; line-height: 1.6; font-size: 0.95rem;">
                                        <strong>73% of AirPod issues occur after the 30-day warranty expires.</strong> Don't leave yourself unprotected - extend your coverage now and save up to 25% compared to replacement costs.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 32px; padding: 28px; background: linear-gradient(135deg, #284064 0%, #1e2f4a 100%); border-radius: 16px; color: white; text-align: center; box-shadow: 0 8px 32px rgba(40, 64, 100, 0.3);">
                            <h3 style="color: white; margin: 0 0 16px 0; font-size: 1.5rem;">🛡️ Protect Your Investment</h3>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 24px 0;">
                                <div style="text-align: center;">
                                    <div style="font-size: 32px; margin-bottom: 8px;">🔒</div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Peace of Mind</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">Full coverage for months</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 32px; margin-bottom: 8px;">💰</div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Save Money</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">Up to 25% savings</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 32px; margin-bottom: 8px;">⚡</div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Quick Claims</div>
                                    <div style="font-size: 0.85rem; opacity: 0.9;">Fast replacement process</div>
                                </div>
                            </div>
                            <p style="margin: 24px 0 0 0; font-size: 1rem; opacity: 0.95; line-height: 1.6;">
                                Extended protection plans start at just <strong style="font-size: 1.2rem;" id="lowestWarrantyPrice">£19.99</strong> for <span id="lowestWarrantyMonths">6 months</span> of comprehensive coverage
                            </p>
                        </div>
                        
                        <button class="continue-btn" id="continueBtn4" style="margin-top: 32px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); box-shadow: 0 6px 24px rgba(40, 167, 69, 0.4); font-size: 1.1rem; padding: 20px; font-weight: 700;">
                            🛡️ View Extended Protection Plans →
                        </button>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <a href="#" id="skipWarrantyStep4" style="color: #6c757d; text-decoration: none; font-size: 0.9rem; opacity: 0.8;">Skip for now</a>
                        </div>
                    </div>
                </div>
                
                <!-- Step 5: Extended Warranty Options -->
                <div class="step-container" id="step5" data-step="5">
                    <h2 style="text-align: center; margin-bottom: 8px;">Choose Your Protection Plan</h2>
                    <p style="text-align: center; color: #6c757d; margin-bottom: 32px;">Select the coverage that works best for you</p>
                    
                    <div class="countdown-timer" id="countdownTimer">
                        Special pricing expires in: <span id="timerDisplay">15:00</span>
                    </div>
                    
                    <div class="warranty-options">
                        <div class="warranty-card" data-plan="3month" id="warranty3Month" style="display: none;">
                            <h3>3-Month Protection</h3>
                            <div class="warranty-price">£0.00</div>
                            <div class="warranty-details">£0.00/month</div>
                        </div>
                        <div class="warranty-card selected" data-plan="6month" id="warranty6Month">
                            <div class="warranty-badge">Most Popular</div>
                            <h3>6-Month Protection</h3>
                            <div class="warranty-price">£0.00</div>
                            <div class="warranty-details">£0.00/month</div>
                        </div>
                        <div class="warranty-card" data-plan="12month" id="warranty12Month">
                            <div class="warranty-badge" style="background: #ffc107; color: #856404;">Best Value</div>
                            <h3>12-Month Protection</h3>
                            <div class="warranty-price">£0.00</div>
                            <div class="warranty-details">£0.00/month</div>
                        </div>
                    </div>
                    
                    <div class="trust-badges">
                        <div class="trust-badge">✓ 30-day money back guarantee</div>
                        <div class="trust-badge">✓ Instant activation</div>
                    </div>
                    
                    <div class="skip-link">
                        <a href="#" id="skipWarranty">Continue without protection</a>
                    </div>
                    
                    <button class="continue-btn" id="continueBtn5">Continue</button>
                </div>
                
                <!-- Step 6: Accessory Upsell -->
                <div class="step-container" id="step6" data-step="6">
                    <h2 style="text-align: center; margin-bottom: 8px;">Complete Your Setup</h2>
                    <p style="text-align: center; color: #6c757d; margin-bottom: 32px;">Frequently bought together</p>
                    
                    <div class="accessory-section" id="addonSalesSection">
                        <span class="bundle-label">Bundle Deal</span>
                        <div class="accessory-grid" id="addonSalesGrid">
                            <!-- Add-on sales will be dynamically loaded here -->
                        </div>
                        <div style="text-align: center; margin-top: 24px;" id="addonSalesPricing">
                            <!-- Pricing will be dynamically calculated and displayed here -->
                        </div>
                    </div>
                    
                    <div class="skip-link">
                        <a href="#" id="skipAccessories">Skip accessories</a>
                    </div>
                    
                    <button class="continue-btn" id="continueBtn6">Continue</button>
                </div>
                
                <!-- Help Options Step (shown when user clicks "I need help" on any setup step) -->
                <div class="step-container" id="helpOptionsStep" data-step="help" style="display: none;">
                    <h2 style="text-align: center; margin-bottom: 8px;">We're Here to Help</h2>
                    <p style="text-align: center; color: #6c757d; margin-bottom: 32px;">Choose how you'd like to proceed</p>
                    
                    <div style="display: grid; gap: 20px; margin-bottom: 32px;">
                        <!-- Option 1: Restart Pairing Process -->
                        <div class="help-option-card" id="helpOptionRestart" style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="display: flex; align-items: start; gap: 16px;">
                                <div style="font-size: 32px; flex-shrink: 0;">🔄</div>
                                <div style="flex: 1;">
                                    <h3 style="margin-top: 0; margin-bottom: 8px; color: #1a1a1a; font-size: 1.2rem;">Restart Pairing Process</h3>
                                    <p style="color: #6c757d; margin-bottom: 0; line-height: 1.6;">
                                        Start the pairing process again from the beginning. This will reset all setup steps and guide you through each one again.
                                    </p>
                            </div>
                        </div>
                            </div>
                        
                        <!-- Option 2: Free Reconditioning Service -->
                        <div class="help-option-card" id="helpOptionRecondition" style="background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%); border: 2px solid #ffc107; border-radius: 12px; padding: 24px; cursor: pointer; transition: all 0.3s ease; position: relative;">
                            <div style="position: absolute; top: 12px; right: 12px; background: #28a745; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">FREE SERVICE</div>
                            <div style="display: flex; align-items: start; gap: 16px;">
                                <div style="font-size: 32px; flex-shrink: 0;">✨</div>
                                <div style="flex: 1;">
                                    <h3 style="margin-top: 0; margin-bottom: 8px; color: #856404; font-size: 1.2rem;">Free Reconditioning & Pairing Service</h3>
                                    <p style="color: #856404; margin-bottom: 12px; line-height: 1.6;">
                                        Send us your replacement part along with the rest of your AirPod set, and we'll:
                                    </p>
                                    <ul style="color: #856404; margin: 0 0 12px 20px; padding: 0; line-height: 1.8;">
                                        <li>Recondition and clean your AirPods</li>
                                        <li>Pair and synchronise everything together</li>
                                        <li>Return it back to you fully working</li>
                                    </ul>
                                    <p style="color: #856404; margin-bottom: 0; line-height: 1.6; font-weight: 500;">
                                        <strong>All completely free!</strong> We just ask for your positive feedback in return.
                                    </p>
                        </div>
                            </div>
                        </div>
                        
                        <!-- Option 3: Return Item -->
                        <div class="help-option-card" id="helpOptionReturn" style="background: white; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px; cursor: pointer; transition: all 0.3s ease;">
                            <div style="display: flex; align-items: start; gap: 16px;">
                                <div style="font-size: 32px; flex-shrink: 0;">📦</div>
                                <div style="flex: 1;">
                                    <h3 style="margin-top: 0; margin-bottom: 8px; color: #1a1a1a; font-size: 1.2rem;">Return This Item</h3>
                                    <p style="color: #6c757d; margin-bottom: 0; line-height: 1.6;">
                                        If you'd prefer to return this item, we'll guide you through the return process.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Reconditioning Service Form Step (shown when user selects Option 2) -->
                <div class="step-container" id="reconditioningFormStep" data-step="reconditioning" style="display: none;">
                    <h2 style="text-align: center; margin-bottom: 8px;">Free Reconditioning Service</h2>
                    <p style="text-align: center; color: #6c757d; margin-bottom: 32px;">Please provide your details so we can arrange collection</p>
                    
                    <div style="background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%); border: 2px solid #ffc107; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                        <h4 style="color: #856404; margin-top: 0; margin-bottom: 12px; font-size: 1.1rem;">What Happens Next?</h4>
                        <ol style="color: #856404; margin: 0; padding-left: 20px; line-height: 1.8;">
                            <li>We'll send you a prepaid return label</li>
                            <li>Package your replacement part with your existing AirPods</li>
                            <li>We'll recondition, pair, and synchronise everything</li>
                            <li>We'll return your fully working AirPods set</li>
                            <li>You leave us positive feedback - that's it!</li>
                        </ol>
                    </div>
                    
                    <form id="reconditioningForm" style="max-width: 600px; margin: 0 auto;">
                        <div style="margin-bottom: 20px;">
                            <label for="reconditionName" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Full Name *</label>
                            <input
                                type="text"
                                id="reconditionName"
                                class="security-input"
                                placeholder="John Doe"
                                required
                                autocomplete="name"
                                autocapitalize="words"
                                inputmode="text"
                                enterkeyhint="next"
                                style="text-align: left; padding-left: 16px; letter-spacing: normal; text-transform: none;"
                            >
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label for="reconditionEmail" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Email Address *</label>
                            <input
                                type="email"
                                id="reconditionEmail"
                                class="security-input"
                                placeholder="john@example.com"
                                required
                                autocomplete="email"
                                inputmode="email"
                                autocapitalize="none"
                                enterkeyhint="next"
                                style="text-align: left; padding-left: 16px; letter-spacing: normal; text-transform: none;"
                            >
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label for="reconditionPhone" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Phone Number *</label>
                            <input
                                type="tel"
                                id="reconditionPhone"
                                class="security-input"
                                placeholder="+44 7700 900123"
                                required
                                autocomplete="tel"
                                inputmode="tel"
                                enterkeyhint="next"
                                style="text-align: left; padding-left: 16px; letter-spacing: normal; text-transform: none;"
                            >
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label for="reconditionAddress" style="display: block; margin-bottom: 8px; color: #1a1a1a; font-weight: 500;">Full Address *</label>
                            <textarea
                                id="reconditionAddress"
                                class="security-input"
                                placeholder="Your full address including postcode"
                                required
                                rows="4"
                                autocomplete="street-address"
                                autocapitalize="words"
                                enterkeyhint="done"
                                style="text-align: left; padding-left: 16px; padding-top: 12px; letter-spacing: normal; text-transform: none; resize: vertical; min-height: 100px;"
                            ></textarea>
                        </div>
                        
                        <div style="margin-bottom: 24px; padding: 16px; background: #f8f9fa; border-radius: 8px;">
                            <label style="display: flex; align-items: start; gap: 12px; cursor: pointer;">
                                <input 
                                    type="checkbox" 
                                    id="reconditionFeedbackAgree" 
                                    required
                                    style="margin-top: 4px; width: 20px; height: 20px; cursor: pointer; flex-shrink: 0;"
                                >
                                <span style="color: #1a1a1a; font-size: 0.95rem; line-height: 1.5;">
                                    I understand that in return for this free service, I will provide positive feedback about my experience *
                                </span>
                                </label>
                            </div>
                        
                        <button type="submit" class="continue-btn" id="submitReconditioningForm" style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);">
                            Submit Request
                        </button>
                    </form>
                        </div>
                
                <!-- Step 7: Stripe Payment -->
                <div class="step-container" id="step7" data-step="7">
                    <div style="margin-bottom: 24px;">
                        <button id="backFromPaymentBtn" class="back-btn" style="background: transparent; border: 2px solid #6c757d; color: #6c757d; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 1rem; font-weight: 500; transition: all 0.2s ease;">
                            ← Back
                        </button>
                    </div>
                    
                    <h2 style="text-align: center; margin-bottom: 8px;">Complete Your Purchase</h2>
                    <p style="text-align: center; color: #6c757d; margin-bottom: 32px;">Secure payment powered by Stripe</p>
                    
                    <div id="paymentSummary" style="background: #f8f9fa; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <h3 style="margin-top: 0; margin-bottom: 16px; color: #1a1a1a;">Order Summary</h3>
                        <div id="paymentItems" style="margin-bottom: 16px;">
                            <!-- Items will be dynamically added here -->
                    </div>
                        <div style="border-top: 2px solid #e8ecf1; padding-top: 16px; margin-top: 16px;">
                            <div style="display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: 600; color: #1a1a1a;">
                                <span>Total:</span>
                                <span id="paymentTotal">£0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Stripe Payment Element Container -->
                    <div style="background: #ffffff; border: 2px solid #e8ecf1; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                        <div id="stripe-payment-element">
                            <!-- Stripe Elements will be mounted here -->
                        </div>
                    </div>
                    
                    <div id="paymentError" style="display: none; background: #f8d7da; color: #721c24; padding: 12px; border-radius: 8px; margin-bottom: 16px;"></div>
                    
                    <button class="continue-btn" id="processPaymentBtn" style="background: linear-gradient(135deg, #0064D2 0%, #0052a3 100%);">
                        Pay Securely
                    </button>
                    
                    <div style="text-align: center; margin-top: 16px;">
                        <p style="color: #6c757d; font-size: 0.85rem; margin-bottom: 8px;">Secured by</p>
                        <div style="display: inline-flex; align-items: center; gap: 8px;">
                            <svg width="60" height="24" viewBox="0 0 60 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8.5 12C8.5 9.5 10.5 7.5 13 7.5C15.5 7.5 17.5 9.5 17.5 12C17.5 14.5 15.5 16.5 13 16.5C10.5 16.5 8.5 14.5 8.5 12Z" fill="#635BFF"/>
                                <path d="M22 7.5H25V16.5H22V7.5ZM28 7.5H31L33.5 13L36 7.5H39V16.5H36V11L33.5 16.5H30.5L28 11V16.5H25V7.5H28Z" fill="#635BFF"/>
                            </svg>
                            <span style="color: #635BFF; font-weight: 600; font-size: 0.9rem;">Stripe</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Exit Intent Modal -->
    <div class="exit-modal" id="exitModal">
        <div class="exit-modal-content">
            <h3>Wait! Don't lose your warranty activation</h3>
            <p>Complete your registration now and save 20% on extended protection</p>
            <div class="exit-modal-buttons">
                <button class="btn btn-primary" id="stayButton">Complete Registration</button>
                <button class="btn btn-secondary" id="leaveButton">Leave Anyway</button>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="image-modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" id="modalClose" aria-label="Close modal" title="Close"></button>
            <button class="modal-nav modal-prev" id="modalPrev" aria-label="Previous image">‹</button>
            <img id="modalImage" src="" alt="Product photo">
            <button class="modal-nav modal-next" id="modalNext" aria-label="Next image">›</button>
        </div>
    </div>

    <!-- Cookie Consent Banner -->
    <div id="cookieConsentBanner" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background: #1a1a1a; color: white; padding: 20px; z-index: 10000; box-shadow: 0 -2px 10px rgba(0,0,0,0.2);">
        <div style="max-width: 1200px; margin: 0 auto; display: flex; flex-direction: column; gap: 16px; align-items: flex-start;">
            <div style="flex: 1;">
                <h3 style="margin: 0 0 8px 0; font-size: 1.1rem;">🍪 Cookie Consent</h3>
                <p style="margin: 0; font-size: 0.9rem; line-height: 1.5; color: #e0e0e0;">
                    We use cookies to improve your experience and track how you use our website. 
                    <a href="#" id="cookiePolicyLink" style="color: #4a9eff; text-decoration: underline;">Learn more</a>
                </p>
            </div>
            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                <button id="acceptAllCookies" style="background: #0064D2; color: white; border: none; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                    Accept All
                </button>
                <button id="acceptEssentialCookies" style="background: transparent; color: white; border: 1px solid #666; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                    Essential Only
                </button>
                <button id="customizeCookies" style="background: transparent; color: white; border: 1px solid #666; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem;">
                    Customize
                </button>
            </div>
        </div>
    </div>

    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
    <script src="js/cookie-consent.js"></script>
    <script src="js/warranty-registration.js?v=1.2.3.031"></script>
</body>
</html>
